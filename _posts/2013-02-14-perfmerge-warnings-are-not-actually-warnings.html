---
layout: post
status: publish
published: true
title: Perfmerge++ Warnings are not actually warnings!
author:
  display_name: Rob Petti
  login: rpetti
  email: rob.petti@gmail.com
  url: http://www.robpetti.com
author_login: rpetti
author_email: rob.petti@gmail.com
author_url: http://www.robpetti.com
excerpt: "I recently did a migration of source code from one perforce server to another.
  During the merge process, I ran into an odd warning:\r\n<pre class=\"code\">\r\nperfmerge++
  warning:\r\n        No mapping for change 293174 in database &#47;x&#47;sourceserver&#47;server&#47;.
  Rejecting.\r\n<&#47;pre>\r\n\r\nThinking that it was just a dead or missing changeset,
  I skipped right along and proceeded to put the server into production. Verify came
  back ok, so I figured everything was fine.\r\n\r\nIt was not...\r\n"
wordpress_id: 139
wordpress_url: http://robpetti.com/?p=139
date: '2013-02-14 19:15:46 -0700'
date_gmt: '2013-02-15 00:15:46 -0700'
categories:
- Perforce
tags: []
comments:
- id: 3011
  author: Matt O
  author_email: matto@telestream.net
  author_url: ''
  date: '2013-12-22 01:31:57 -0700'
  date_gmt: '2013-12-22 06:31:57 -0700'
  content: "I ran into the same problem.  I have a ticket in with support to find
    out how to revert these.  When I search for these changelists they do not show
    up as existing.  \r\n\r\nThank you for your article.  Instead of not knowing what
    was going on it was easy to determine a course of action.  \r\n\r\nMatt"
---
<p>I recently did a migration of source code from one perforce server to another. During the merge process, I ran into an odd warning:</p>
<pre class="code">
perfmerge++ warning:<br />
        No mapping for change 293174 in database &#47;x&#47;sourceserver&#47;server&#47;. Rejecting.<br />
<&#47;pre></p>
<p>Thinking that it was just a dead or missing changeset, I skipped right along and proceeded to put the server into production. Verify came back ok, so I figured everything was fine.</p>
<p>It was not...<br />
<a id="more"></a><a id="more-139"></a></p>
<p>It seems that perfmerge has an annoying tendency to quit at the first sign of trouble, then throw a 'warning' rather than a full blown error message. In this case, it was about to write out the db.changes* tables, then decided against it. When I brought the server back online, there were file revisions, but no changesets or change descriptions to speak of. This is obviously a huge problem!</p>
<p>I checked both source p4 roots, but couldn't find the changes in question. Out of desperation, I took checkpoints of both roots, and grepped the entire checkpoint looking for the changeset numbers that were throwing warning. There were two things that I found.</p>
<p>The first thing was that somehow, someone had managed to open files under a pending changeset that didn't exist. I'm not entirely sure how that happened, but it did. Once that was found, it was a simple matter of reverting all the files opened under that missing changeset.</p>
<p>The second thing I found wrong was that perfmerge apparently had an issue with the way my job names were formatted, which caused any changeset tied to that job to fail to merge. In my case, we don't make heavy use of jobs, and the one with the issue appeared to be accidentally created. After removing the fix tying the changeset to it and deleting it, the merge proceeded to work fine.</p>
<p>Hopefully this helps some people. I regret that I didn't save my entire solution somewhere, but the perforce documentation should cover most of what's required to do the same.</p>
